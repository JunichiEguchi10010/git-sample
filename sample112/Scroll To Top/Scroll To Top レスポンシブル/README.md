WebDesign html css javascript ãƒˆãƒƒãƒ—ã¸æˆ»ã‚‹ãƒœã‚¿ãƒ³ã®ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œï¼ˆScroll To Topï¼‰20250621

âœ… ãƒã‚¤ãƒ³ãƒˆ
å¯¾å¿œå†…å®¹	                èª¬æ˜
è¡¨ç¤ºã‚¿ã‚¤ãƒŸãƒ³ã‚°ã®èª¿æ•´	ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã©ã®ç«¯æœ«ã§ã‚‚ã€Œã¡ã‚‡ã†ã©ã„ã„ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã€ã§ãƒœã‚¿ãƒ³ãŒå‡ºç¾ã™ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚
ãƒœã‚¿ãƒ³ã®ã‚µã‚¤ã‚ºãƒ»ä½ç½®	å°ã•ã„ç”»é¢ã§ã¯ã‚¹ãƒšãƒ¼ã‚¹ã‚’åœ§è¿«ã—ãªã„ã‚ˆã†ã«èª¿æ•´ã€‚
ä¿å®ˆæ€§	               JavaScriptã§ã‚µã‚¤ã‚ºåˆ¥ã®ã—ãã„å€¤ã‚’é–¢æ•°åŒ–ã—ã¦ç®¡ç†ã—ã‚„ã™ãã€‚

âœ… ç–‘ä¼¼ã‚³ãƒ¼ãƒ‰
1. ãƒšãƒ¼ã‚¸ã®HTMLãŒã™ã¹ã¦èª­ã¿è¾¼ã¾ã‚ŒãŸã‚‰æ¬¡ã®å‡¦ç†ã‚’å§‹ã‚ã‚‹ï¼š

2. ã€Œãƒˆãƒƒãƒ—ã¸æˆ»ã‚‹ãƒœã‚¿ãƒ³ã€ã®è¦ç´ ã‚’å–å¾—ã™ã‚‹ã€‚

3. ç¾åœ¨ã®ç”»é¢å¹…ã«å¿œã˜ã¦ã€
   - PCãªã‚‰è¡¨ç¤ºé–‹å§‹ä½ç½®ã‚’ 400px ã«è¨­å®š
   - ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆãªã‚‰ 300px
   - ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³ãªã‚‰ 150px ã«ã™ã‚‹

4. ãƒšãƒ¼ã‚¸ã‚’ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã™ã‚‹ãŸã³ã«ã€
   - ç¾åœ¨ã®ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«é‡ãŒã—ãã„å€¤ã‚’è¶…ãˆã¦ã„ã‚Œã°ãƒœã‚¿ãƒ³ã‚’è¡¨ç¤ºã™ã‚‹
   - è¶…ãˆã¦ã„ãªã‘ã‚Œã°ãƒœã‚¿ãƒ³ã‚’éè¡¨ç¤ºã«ã™ã‚‹

5. ãƒœã‚¿ãƒ³ãŒã‚¯ãƒªãƒƒã‚¯ã•ã‚ŒãŸã‚‰ã€
   - ãƒšãƒ¼ã‚¸ã®ä¸€ç•ªä¸Šã¸ã€æ»‘ã‚‰ã‹ã«ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã™ã‚‹

   document.addEventListener('DOMContentLoaded', () => {
  const scrollBtn = document.getElementById('scrollToTopBtn');

  // è¡¨ç¤ºã—ãã„å€¤ã‚’ãƒ‡ãƒã‚¤ã‚¹å¹…ã«å¿œã˜ã¦è¿”ã™é–¢æ•°
  const getScrollThreshold = () => {
    const width = window.innerWidth;
    if (width >= 1024) return 400; // PC
    if (width >= 768) return 300;  // ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆ
    return 150;                    // ã‚¹ãƒãƒ›
  };

  // ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«æ™‚ã®è¡¨ç¤ºåˆ¶å¾¡
  window.addEventListener('scroll', () => {
    const threshold = getScrollThreshold();
    if (window.scrollY > threshold) {
      scrollBtn.classList.add('show');
    } else {
      scrollBtn.classList.remove('show');
    }
  });

  // ã‚¹ãƒ ãƒ¼ã‚¹ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã§ãƒˆãƒƒãƒ—ã¸æˆ»ã‚‹
  scrollBtn.addEventListener('click', () => {
    window.scrollTo({
      top: 0,
      behavior: 'smooth'
    });
  });
});


âœ… ã‚³ãƒ¼ãƒ‰è§£èª¬

document.addEventListener('DOMContentLoaded', () => {
æ„å‘³ï¼šHTMLã®æ§‹é€ ï¼ˆDOMï¼‰ãŒã™ã¹ã¦èª­ã¿è¾¼ã¾ã‚ŒãŸã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§ã€ä»¥ä¸‹ã®é–¢æ•°ã‚’å®Ÿè¡Œã™ã‚‹ã€‚
âœ… ç†ç”±ï¼šJavaScriptãŒHTMLã®è¦ç´ ï¼ˆãƒœã‚¿ãƒ³ãªã©ï¼‰ã‚’ç¢ºå®Ÿã«å–å¾—ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ãŸã‚ã€‚

  const scrollBtn = document.getElementById('scrollToTopBtn');
æ„å‘³ï¼šã€Œãƒˆãƒƒãƒ—ã¸æˆ»ã‚‹ã€ãƒœã‚¿ãƒ³ã®è¦ç´ ã‚’ã€scrollBtn ã¨ã„ã†å¤‰æ•°ã«ä»£å…¥ã€‚
âœ… ç”¨é€”ï¼šå¾Œã®å‡¦ç†ã§ãƒœã‚¿ãƒ³ã‚’è¡¨ç¤ºãƒ»éè¡¨ç¤ºãƒ»ã‚¯ãƒªãƒƒã‚¯ãªã©ã§æ“ä½œã™ã‚‹ãŸã‚ã€‚

  // è¡¨ç¤ºã—ãã„å€¤ã‚’ãƒ‡ãƒã‚¤ã‚¹å¹…ã«å¿œã˜ã¦è¿”ã™é–¢æ•°
  const getScrollThreshold = () => {
    const width = window.innerWidth;
æ„å‘³ï¼šç¾åœ¨ã®ç”»é¢å¹…ã‚’ window.innerWidth ã§å–å¾—ã€‚
âœ… ç”¨é€”ï¼šãƒ‡ãƒã‚¤ã‚¹ãŒã‚¹ãƒãƒ›ãƒ»ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆãƒ»PCã®ã©ã‚Œã‹ã‚’åˆ¤å®šã™ã‚‹ãŸã‚ã€‚

    if (width >= 1024) return 400; // PC
æ„å‘³ï¼šç”»é¢å¹…ãŒ1024pxä»¥ä¸Šãªã‚‰PCã¨åˆ¤æ–­ã—ã€ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«è¡¨ç¤ºã—ãã„å€¤ã‚’400pxã«è¨­å®šã€‚

    if (width >= 768) return 300;  // ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆ
æ„å‘³ï¼š768pxä»¥ä¸Šãªã‚‰ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆã¨åˆ¤æ–­ã—ã€ã—ãã„å€¤ã‚’300pxã«ã€‚

    return 150;                    // ã‚¹ãƒãƒ›
  };
æ„å‘³ï¼šãã‚Œä»¥å¤–ï¼ˆ768pxæœªæº€ï¼ã‚¹ãƒãƒ›ï¼‰ãªã‚‰ã€ã—ãã„å€¤ã‚’150pxã«è¨­å®šã€‚

  window.addEventListener('scroll', () => {
æ„å‘³ï¼šã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚¤ãƒ™ãƒ³ãƒˆã‚’æ¤œçŸ¥ã—ãŸã¨ãã€é–¢æ•°ã‚’å®Ÿè¡Œã™ã‚‹ã€‚

    const threshold = getScrollThreshold();
æ„å‘³ï¼šç¾åœ¨ã®ç”»é¢ã‚µã‚¤ã‚ºã«å¿œã˜ã¦è¡¨ç¤ºã™ã‚‹ãŸã‚ã®ã—ãã„å€¤ï¼ˆã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«é‡ï¼‰ã‚’å–å¾—ã€‚

    if (window.scrollY > threshold) {
æ„å‘³ï¼šç¾åœ¨ã®ç¸¦ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«é‡ï¼ˆscrollYï¼‰ãŒã—ãã„å€¤ã‚’è¶…ãˆãŸã‚‰â€¦

      scrollBtn.classList.add('show');
æ„å‘³ï¼šã€Œshowã€ã‚¯ãƒ©ã‚¹ã‚’ãƒœã‚¿ãƒ³ã«è¿½åŠ ã—ã¦ã€CSSã§ãƒœã‚¿ãƒ³ã‚’ãµã‚ã£ã¨è¡¨ç¤ºã€‚

    } else {
      scrollBtn.classList.remove('show');
æ„å‘³ï¼šã—ãã„å€¤ä»¥ä¸‹ãªã‚‰ã€Œshowã€ã‚¯ãƒ©ã‚¹ã‚’å¤–ã—ã¦ã€ãƒœã‚¿ãƒ³ã‚’éè¡¨ç¤ºã«ã™ã‚‹ã€‚

    }
  });
æ„å‘³ï¼šã€Œscrollã€ã‚¤ãƒ™ãƒ³ãƒˆã¨ãã®ä¸­èº«ã®å‡¦ç†ã®çµ‚äº†ã€‚

  scrollBtn.addEventListener('click', () => {
æ„å‘³ï¼šãƒœã‚¿ãƒ³ãŒã‚¯ãƒªãƒƒã‚¯ã•ã‚ŒãŸã‚‰æ¬¡ã®å‡¦ç†ã‚’å®Ÿè¡Œã™ã‚‹ã€‚

    window.scrollTo({
      top: 0,
      behavior: 'smooth'
    });
æ„å‘³ï¼šãƒšãƒ¼ã‚¸ã®ä¸€ç•ªä¸Šã¾ã§ã€**æ»‘ã‚‰ã‹ã«ï¼ˆã‚¹ãƒ ãƒ¼ã‚ºã«ï¼‰**ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã™ã‚‹ã‚ˆã†æŒ‡ç¤ºã€‚
âœ… top: 0 â†’ æœ€ä¸Šéƒ¨
âœ… behavior: 'smooth' â†’ ã‚†ã£ãã‚Šã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«

  });
});
æ„å‘³ï¼šã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆã®çµ‚äº†ã€ãã—ã¦DOMContentLoadedã®é–¢æ•°ã‚‚çµ‚äº†ã€‚



âœ…  scrollY ã¨ pageYOffset ã®é•ã„
æ¯”è¼ƒé …ç›®	    window.scrollY	                            window.pageYOffset
æ„å‘³	        å‚ç›´æ–¹å‘ã®ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ä½ç½®ã‚’å–å¾—ã™ã‚‹	        åŒã˜ãå‚ç›´æ–¹å‘ã®ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ä½ç½®ã‚’å–å¾—
å€¤ã®å†…å®¹	    ãƒšãƒ¼ã‚¸ã®å…ˆé ­ã‹ã‚‰ã®Yè»¸æ–¹å‘ã®ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«é‡	    åŒã˜ããƒšãƒ¼ã‚¸ã®å…ˆé ­ã‹ã‚‰ã®ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«é‡
å‹	            numberï¼ˆå˜ä½ï¼špxï¼‰	                        numberï¼ˆå˜ä½ï¼špxï¼‰
å¯¾å¿œãƒ–ãƒ©ã‚¦ã‚¶	IE9ä»¥ä¸Šã€ãƒ¢ãƒ€ãƒ³ãƒ–ãƒ©ã‚¦ã‚¶ã™ã¹ã¦	            IE9ä»¥ä¸Šã€ãƒ¢ãƒ€ãƒ³ãƒ–ãƒ©ã‚¦ã‚¶ã™ã¹ã¦
å®Ÿè³ªçš„ãªé•ã„	ã»ã¨ã‚“ã©ãªã„ï¼ˆåŒã˜å€¤ã‚’è¿”ã™ï¼‰	            åŒã˜ãåŒç­‰ã«ä½¿ãˆã‚‹
æ­´å²çš„èƒŒæ™¯	    æ¯”è¼ƒçš„æ–°ã—ã„ï¼ˆHTML5ä»¥é™ã§æ¨™æº–åŒ–ï¼‰	        å¤ãã‹ã‚‰ã‚ã‚‹ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£

ğŸ” å®Ÿå‹™ã§ã¯ã©ã£ã¡ã‚’ä½¿ã†ï¼Ÿ
ãƒ¢ãƒ€ãƒ³ãªã‚³ãƒ¼ãƒ‰ã§ã¯ scrollY ã‚’ä½¿ã†ã“ã¨ãŒå¤šã„ã§ã™ã€‚
**IEå¯¾å¿œãŒå¿…è¦ãªå ´åˆï¼ˆç¾åœ¨ã¯ã»ã¼ãªã„ï¼‰**ã¯ pageYOffset ã®æ–¹ãŒæ­´å²çš„ã«ä½¿ã‚ã‚Œã¦ã„ã¾ã—ãŸã€‚

// ã©ã¡ã‚‰ã‚‚åŒã˜çµæœã‚’è¿”ã™ï¼ˆå‚ç›´ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ä½ç½®ï¼‰
console.log(window.scrollY);
console.log(window.pageYOffset);


âœ… â‘¡ addEventListener ã®ç¬¬3å¼•æ•°ã‚ªãƒ—ã‚·ãƒ§ãƒ³ { passive: true } ã¨ã¯ï¼Ÿ
ğŸ§¾ æ›¸å¼ï¼š
element.addEventListener(type, listener, options);
ã“ã® options ã«æ¸¡ã›ã‚‹ä¸»ãªã‚‚ã®ï¼š

ã‚ªãƒ—ã‚·ãƒ§ãƒ³å	        å‹	                     èª¬æ˜
passive	        boolean	            trueã«ã™ã‚‹ã¨ã‚¤ãƒ™ãƒ³ãƒˆã®ä¸­ã§preventDefault()ã§ããªããªã‚‹
capture	        boolean	            ã‚­ãƒ£ãƒ—ãƒãƒ£ãƒ•ã‚§ãƒ¼ã‚ºã§ã‚¤ãƒ™ãƒ³ãƒˆã‚’å‡¦ç†ã™ã‚‹ã‹ï¼ˆé€šå¸¸ã¯falseï¼‰
once	        boolean	            ä¸€åº¦ã ã‘ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã‚’å®Ÿè¡Œã—ã¦è‡ªå‹•çš„ã«å‰Šé™¤ã™ã‚‹

ğŸ§  passive: true ã®ä¸»ãªä½¿ã„ã©ã“ã‚ï¼š
ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ç³»ã‚¤ãƒ™ãƒ³ãƒˆï¼ˆscroll / touchmoveï¼‰ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å‘ä¸Šã«ä½¿ã†ã€‚
ãƒ–ãƒ©ã‚¦ã‚¶ãŒã€Œã“ã®ã‚¤ãƒ™ãƒ³ãƒˆã§ã¯preventDefault()ã•ã‚Œãªã„ã€ã¨ã‚ã‹ã‚‹ã®ã§æœ€é©åŒ–ã§ãã‚‹ã€‚

// ä¾‹ï¼šãƒ‘ãƒƒã‚·ãƒ–ãªã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
window.addEventListener('scroll', () => {
  console.log('ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ä¸­...');
}, { passive: true });
âš ï¸ passive: true ã®æ³¨æ„ç‚¹
ã“ã®è¨­å®šã‚’ã™ã‚‹ã¨ã€event.preventDefault()ãŒä½¿ãˆãªããªã‚Šã¾ã™ã€‚

// ã“ã‚Œã¯ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ï¼
window.addEventListener('touchmove', (e) => {
  e.preventDefault(); // âŒ passive: true ã®å ´åˆã¯ä¾‹å¤–ãŒç™ºç”Ÿ
}, { passive: true });

âœ… å®Ÿå‹™ã§ã®åˆ©ç”¨ä¾‹ã¾ã¨ã‚
ã‚¤ãƒ™ãƒ³ãƒˆç¨®é¡	            passiveæ¨å¥¨ï¼Ÿ	            ç†ç”±ãƒ»ãƒ¡ãƒ¢
scroll	                âœ… true	                    ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å‘ä¸Šã€preventDefaultä¸è¦ãªã‚‰OK
touchstart / touchmove	âœ… æ¡ä»¶ä»˜ã	                ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«å¦¨ã’ãªã„ãªã‚‰true
click, keydown	        âŒ é€šå¸¸ä¸è¦	                preventDefault()ä½¿ã†ã“ã¨ãŒã‚ã‚‹ãŸã‚

ğŸ§© æœ€çµ‚ä¾‹ï¼šãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã«é…æ…®ã—ãŸ scroll ã‚¤ãƒ™ãƒ³ãƒˆ
window.addEventListener('scroll', () => {
  // é«˜é€Ÿãªã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚¤ãƒ™ãƒ³ãƒˆå‡¦ç†
  checkScrollPosition();
}, { passive: true });
