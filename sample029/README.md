WordPress カスタム投稿タイプ（CPT）　20250416

カスタム投稿タイプとは？
WordPressでは、初期状態で以下のような「投稿タイプ（Post Type）」が用意されています：

投稿タイプ	                    内容
投稿（post）	            ブログ記事など、時系列で並ぶ情報
固定ページ（page）	        お問い合わせ、会社概要などの静的ページ
これら以外にも、「自分で新しい種類の投稿」を追加したいときに使うのが カスタム投稿タイプ です。

WordPressに最初からあるデフォルトの投稿タイプ一覧

投稿タイプ名（スラッグ）	                説明	                                管理画面に表示される？
post	                        通常の「投稿」。ブログ記事などに使う	          ✅ 表示される
page	                        固定ページ（例：お問い合わせ、会社概要）    	  ✅ 表示される
attachment	                    メディア（画像・PDFなど）               	    ❌（メディアライブラリ経由で管理）
revision	                    投稿のリビジョン（過去の編集履歴）	              ❌（裏側で管理される）
nav_menu_item               	メニューの各項目                            	❌（外観→メニューで操作）
custom_css	                    テーマカスタマイザーの追加CSS               	❌（外観→カスタマイズ）
customize_changeset	            カスタマイザーの変更履歴	❌
oembed_cache	                埋め込み（YouTubeなど）のキャッシュ	❌


【プラグインを使わずにfunctions.phpに自分でコードを書く方法】
function register_news_post_type() {
  register_post_type('news', [
    'labels' => [
      'name' => 'お知らせ',
      'singular_name' => 'お知らせ'
    ],
    'public' => true,
    'has_archive' => true,
    'menu_position' => 5,
    'show_in_rest' => true,
    'supports' => ['title', 'editor', 'thumbnail', 'excerpt']
  ]);
}
add_action('init', 'register_news_post_type');
<!-- WordPressが 'init'（初期化）というタイミングになったときに、register_news_post_type という自作の関数を実行する -->
理論：「register_post_type()をinitフックで呼び出す

 init を使わずに register_post_type() を書くとどうなる？
→ 投稿タイプの登録が「WordPressが準備できていない段階」で実行される可能性があり、正しく動作しません（管理画面に出ない・表示されないなどの不具合）。
そのため 「投稿タイプの登録は必ず init でやる」 のがWordPressの公式なベストプラクティスです。


【プラグインを使ってカスタム投稿タイプを作る方法】
1. プラグインをインストールする
WordPress管理画面 → 「プラグイン」 → 「新規追加」
「Custom Post Type UI」と検索して、インストール＆有効化

2. カスタム投稿タイプを追加する
管理画面左メニューに「CPT UI」が追加されるのでクリック
「投稿タイプを追加」を選択

項目名	                                入力例	                                内容
投稿タイプスラッグ	                     news                       	半角英数字（URLにも使われる）
複数形ラベル	                        お知らせ                    	一覧ページなどで使われる名前
単数形ラベル	                        お知らせ                    	投稿編集画面などで使われる名前

3. 詳細設定をする（必要に応じて）
「公開」「アーカイブ」「REST APIに表示」などを選択（基本はデフォルトでもOK）
投稿に使う機能（タイトル・本文・アイキャッチ画像など）をチェック

4. 保存するとメニューに追加される
「お知らせ」など、自分で設定した投稿タイプが左メニューに表示されます。

そこから投稿・編集が可能になります。

💡 注意点・デメリット
CPT UIは投稿タイプの作成はできるが表示テンプレートまでは作らない
→ 自作テーマで表示させるには single-news.php や archive-news.php のテンプレートファイルが必要

プラグインを削除すると設定は残らない（投稿自体は消えないけど非表示になる）


【カスタム投稿タイプ：例】
作りたいもの	                    投稿タイプ名（例）	                    説明
お知らせ	                        news                        	通常の投稿とは別に管理・表示したい
実績・制作例	                    works                       	ギャラリーページや実績一覧として管理したい
商品情報	                        products                    	WooCommerceでも使われています
イベント情報	                    event                       	開催日・場所などのカスタム情報を持たせる

