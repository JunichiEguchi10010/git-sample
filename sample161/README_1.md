JavaScript éåŒæœŸå‡¦ç† async/await ã«ã¤ã„ã¦ 20250901

1.éåŒæœŸå‡¦ç†ã¨ã¯ï¼Ÿ

JavaScript ã¯ã€Œä¸€åº¦ã«ã²ã¨ã¤ã®å‡¦ç†ã€ã—ã‹ã§ãã¾ã›ã‚“ï¼ˆã‚·ãƒ³ã‚°ãƒ«ã‚¹ãƒ¬ãƒƒãƒ‰ï¼‰ã€‚
ã§ã‚‚å®Ÿéš›ã®é–‹ç™ºã§ã¯ã€
ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹ï¼ˆAPI å‘¼ã³å‡ºã—ï¼‰
ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚€
ã‚¿ã‚¤ãƒãƒ¼å‡¦ç†ã‚’ã™ã‚‹
ã¨ã„ã£ãŸã€Œæ™‚é–“ãŒã‹ã‹ã‚‹å‡¦ç†ã€ãŒã‚ã‚Šã¾ã™ã€‚
ã“ã‚Œã‚’ å¾…ãŸãšã«æ¬¡ã®å‡¦ç†ã‚’é€²ã‚ã‚‹ ä»•çµ„ã¿ãŒã€ŒéåŒæœŸå‡¦ç†ã€ã§ã™ã€‚

2. Promise ã¨ async/await ã®é–¢ä¿‚

æ˜”ã¯ã€Œã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯é–¢æ•°ã€ã§éåŒæœŸå‡¦ç†ã‚’æ‰±ã£ã¦ã„ã¾ã—ãŸãŒã€è¤‡é›‘ã«ãªã‚Šã‚„ã™ã„ã®ã§ Promise ãŒç™»å ´ã—ã¾ã—ãŸã€‚

Promiseãƒ™ãƒ¼ã‚¹ã®ã‚³ãƒ¼ãƒ‰
fetch("https://example.com/data.json") // â‘  Promiseã‚’è¿”ã™é–¢æ•°
  .then(response => response.json())   // â‘¡ ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’JSONã«å¤‰æ›ï¼ˆã“ã‚Œã‚‚Promiseï¼‰
  .then(data => {                      // â‘¢ JSONãƒ‡ãƒ¼ã‚¿ã‚’å—ã‘å–ã£ã¦å‡¦ç†
    console.log("å–å¾—æˆåŠŸ:", data);
  })
  .catch(error => {                    // â‘£ ã©ã“ã‹ã§ã‚¨ãƒ©ãƒ¼ãŒèµ·ããŸã‚‰ã“ã“ã§å‡¦ç†
    console.error("ã‚¨ãƒ©ãƒ¼:", error);
  });

âœ… ã‚³ãƒ¼ãƒ‰ã«å«ã¾ã‚Œã¦ã„ã‚‹è¦ç´ 
è¦ç´ 	            å«ã¾ã‚Œã¦ã„ã‚‹ã‹	    èª¬æ˜
Promise	            âœ”ï¸	            fetch() ã‚„ .then() ã¯ã™ã¹ã¦ Promise ã‚’ä½¿ã£ãŸéåŒæœŸå‡¦ç†
ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯é–¢æ•°     âœ”ï¸              .then() ã‚„ .catch() ã«æ¸¡ã•ã‚Œã¦ã„ã‚‹é–¢æ•°ã¯ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯
ã¤ã¾ã‚Šã€Promiseãƒ™ãƒ¼ã‚¹ã®ã‚³ãƒ¼ãƒ‰ã®ä¸­ã«ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯é–¢æ•°ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã¨ã„ã†æ§‹é€ ã§ã™ã€‚

ä¸Šè¨˜ã®ã‚ˆã†ã«Promise ã¯ä¾¿åˆ©ã§ã™ãŒã€.then().then().catch() ã¨ã¤ãªã’ã‚‹æ›¸ãæ–¹ãŒã¡ã‚‡ã£ã¨èª­ã¿ã«ãã„ã‚“ã§ã™ã‚ˆã­ã€‚

ãã“ã§ç™»å ´ã—ãŸã®ãŒ async/awaitã€‚
Promise ã‚’ã€ŒåŒæœŸå‡¦ç†ã£ã½ãã€æ›¸ã‘ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

ğŸŸ§ (é‡è¦)
3. async/await ã®åŸºæœ¬

ğŸŸ§ async
é–¢æ•°ã®å‰ã«æ›¸ãã¨ã€ãã®é–¢æ•°ã¯å¿…ãš Promise ã‚’è¿”ã™é–¢æ•°ã«ãªã‚Šã¾ã™ã€‚

ğŸŸ§ await
Promise ã®çµæœãŒè¿”ã£ã¦ãã‚‹ã¾ã§éåŒæœŸå‡¦ç†ã®çµæœï¼ˆå€¤ï¼‰ã‚’ã€Œå¾…ã¤ã€ã“ã¨ãŒã§ãã¾ã™ã€‚
ãŸã ã— await ã¯ async é–¢æ•°ã®ä¸­ã§ã—ã‹ä½¿ãˆã¾ã›ã‚“ã€‚


async/awaitã¯ç³–è¡£æ§‹æ–‡ï¼ˆsyntaxï¼‰ã§ã™ã€‚ä»¥ä¸‹ã§è©³ã—ãæ•´ç†ã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼š

ğŸ§  async/await ã®æ­£ä½“ã¯ï¼Ÿ
ç”¨èª	    ç¨®é¡	            èª¬æ˜
async	ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ï¼ˆæ§‹æ–‡ï¼‰	é–¢æ•°ã‚’ã€ŒéåŒæœŸé–¢æ•°ã€ã«ã™ã‚‹ãŸã‚ã®æ§‹æ–‡ã€‚æˆ»ã‚Šå€¤ã¯å¸¸ã« Promise ã«ãªã‚Šã¾ã™ã€‚
await	ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ï¼ˆæ§‹æ–‡ï¼‰	Promise ã®å®Œäº†ã‚’å¾…ã¤ãŸã‚ã®æ§‹æ–‡ã€‚async é–¢æ•°ã®ä¸­ã§ã—ã‹ä½¿ãˆã¾ã›ã‚“ã€‚

async/await ã¯ JavaScriptã®æ§‹æ–‡ã§ã‚ã‚Šã€é–¢æ•°ã§ã‚‚ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã§ã‚‚ãƒ¡ã‚½ãƒƒãƒ‰ã§ã‚‚ã‚ã‚Šã¾ã›ã‚“ã€‚
Promise ã‚’ã‚ˆã‚Šèª­ã¿ã‚„ã™ãæ‰±ã†ãŸã‚ã® ç³–è¡£æ§‹æ–‡ï¼ˆsyntactic sugarï¼‰ ã§ã™ã€‚
å®Ÿéš›ã«ã¯ await ã¯ Promise.then() ã‚’å†…éƒ¨çš„ã«ä½¿ã£ã¦å‡¦ç†ã‚’å¾…ã£ã¦ã„ã¾ã™ã€‚

ğŸŸ§ ä¾‹ï¼šPromise ã‚’ async/await ã«æ›¸ãæ›ãˆ
// Promise ã§æ›¸ãã¨ã“ã†ãªã‚‹
fetch("https://example.com/data.json")
  .then(response => response.json())
  .then(data => {
    console.log("å–å¾—æˆåŠŸ:", data);
  })
  .catch(error => {
    console.error("ã‚¨ãƒ©ãƒ¼:", error);
  });


ğŸŸ§ // async/await ã ã¨ã“ã†æ›¸ã‘ã‚‹
async function getData() {
  try {
    const response = await fetch("https://example.com/data.json");
    const data = await response.json();
    console.log("å–å¾—æˆåŠŸ:", data);
  } catch (error) {
    console.error("ã‚¨ãƒ©ãƒ¼:", error);
  }
}

getData();


ğŸ‘‰ è¦‹ãŸç›®ã¯ã€Œé †ç•ªã«å‡¦ç†ã—ã¦ã„ã‚‹ã€ã‚ˆã†ã«æ›¸ã‘ã‚‹ ã®ã§ã€èª­ã¿ã‚„ã™ã„ã§ã™ã€‚

4. ãƒ¡ãƒªãƒƒãƒˆã¾ã¨ã‚
ğŸŸ¥ then ãƒã‚§ãƒ¼ãƒ³ã‚ˆã‚Šèª­ã¿ã‚„ã™ã„
ğŸŸ¥ æ™®é€šã®åŒæœŸå‡¦ç†ã£ã½ãæ›¸ã‘ã‚‹
ğŸŸ¥ try/catch ã§ã‚¨ãƒ©ãƒ¼å‡¦ç†ãŒã§ãã‚‹

5. è¦šãˆã‚‹ã‚³ãƒ„
async = ã€Œã“ã®é–¢æ•°ã®ä¸­ã§ã¯ await ãŒä½¿ãˆã‚‹ã‚ˆã€
await = ã€ŒPromise ã®çµæœãŒè¿”ã‚‹ã¾ã§å¾…ã¤ã€

ã¤ã¾ã‚Šã‚¤ãƒ¡ãƒ¼ã‚¸ã™ã‚‹ã¨ã€
ğŸ“¦ Promise ã‚’é–‹ã‘ã¦ä¸­èº«ã‚’å–ã‚Šå‡ºã™ãŸã‚ã®é­”æ³•ã®è¨€è‘‰ ãŒ await ã§ã™ã€‚


ğŸŸ¥ await ãŒã€Œå¾…ã¤ã€ã‚‚ã®ã¨ã¯ï¼Ÿ éåŒæœŸå‡¦ç†ã®æµã‚Œã®ä¸­èº«

await ã¯ã€Promise ãŒã€Œè§£æ±ºï¼ˆfulfilledï¼‰ã€ã¾ãŸã¯ã€Œæ‹’å¦ï¼ˆrejectedï¼‰ã€ã•ã‚Œã‚‹ã¾ã§ã€ãã®å ´ã§å‡¦ç†ã‚’ä¸€æ™‚åœæ­¢ã—ã¾ã™ã€‚
ã¤ã¾ã‚Šï¼š

ä½•ã‚’å¾…ã¤ï¼Ÿ â†’ Promise ãŒå®Œäº†ã™ã‚‹ï¼ˆæˆåŠŸã¾ãŸã¯å¤±æ•—ï¼‰ã“ã¨ã€‚

ã„ã¤ã¾ã§å¾…ã¤ï¼Ÿ â†’ Promise ãŒçŠ¶æ…‹ã‚’æŒã¤ã¾ã§ï¼ˆpending â†’ fulfilled or rejectedï¼‰ã€‚ãã‚ŒãŒæ•°ãƒŸãƒªç§’ã§ã‚‚ã€æ•°ç§’ã§ã‚‚ã€ç†è«–ä¸Šã¯æ°¸é ã§ã‚‚å¾…ã¡ã¾ã™ã€‚

ğŸ”§ å®Ÿéš›ã®æµã‚Œï¼ˆå†…éƒ¨çš„ãªå‹•ãï¼‰
js
async function example() {
  const result = await fetch('https://api.example.com/data');
  console.log(result);
}
ã“ã®ã‚³ãƒ¼ãƒ‰ã®è£å´ã§ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ãªã“ã¨ãŒèµ·ãã¦ã„ã¾ã™ï¼š

fetch(...) ã¯ Promise ã‚’è¿”ã™ã€‚

await ã¯ãã® Promise ã‚’å—ã‘å–ã‚Šã€ãã®å®Œäº†ã‚’å¾…ã¤ã€‚

JavaScriptã®ã‚¤ãƒ™ãƒ³ãƒˆãƒ«ãƒ¼ãƒ—ã¯ã€ä»–ã®å‡¦ç†ã‚’é€²ã‚ãªãŒã‚‰ Promise ã®å®Œäº†ã‚’ç›£è¦–ã€‚

Promise ãŒ fulfilled ã«ãªã‚‹ã¨ã€await ã®æ¬¡ã®è¡Œï¼ˆconsole.logï¼‰ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã€‚

å†…éƒ¨çš„ã«ã¯ã€await ã¯ Promise.then(...) ã‚’ä½¿ã£ã¦ã€å®Œäº†æ™‚ã«ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚’ç™»éŒ²ã—ã¦ã„ã‚‹ã‚ˆã†ãªã‚‚ã®ã§ã™ã€‚

ğŸ§µ éåŒæœŸã®ã€Œä¸€æ™‚åœæ­¢ã€ã¨ã€Œå†é–‹ã€
await ã¯ éåŒæœŸé–¢æ•°ã®ä¸­ã§ã®ã¿ä½¿ãˆã‚‹ã€‚

é–¢æ•°ã®å®Ÿè¡Œã¯ä¸€æ™‚åœæ­¢ã•ã‚Œã‚‹ãŒã€ã‚¹ãƒ¬ãƒƒãƒ‰ãŒãƒ–ãƒ­ãƒƒã‚¯ã•ã‚Œã‚‹ã‚ã‘ã§ã¯ãªã„ã€‚

ä»–ã®å‡¦ç†ã¯ä¸¦è¡Œã—ã¦é€²ã‚€ï¼ˆãƒãƒ³ãƒ–ãƒ­ãƒƒã‚­ãƒ³ã‚°ï¼‰ã€‚

ğŸ’¡è£œè¶³ï¼šã‚‚ã— Promise ãŒã™ã§ã«å®Œäº†ã—ã¦ã„ãŸã‚‰ï¼Ÿ
await ã¯å³åº§ã«ãã®å€¤ã‚’è¿”ã—ã¾ã™ã€‚ã¤ã¾ã‚Šã€å¾…ã¤å¿…è¦ãŒãªã„å ´åˆã¯ã™ãã«æ¬¡ã®å‡¦ç†ã«é€²ã¿ã¾ã™ã€‚


â“ PORMISEãŒè§£æ±ºã•ã‚ŒãŸã‚‰ã€æ¬¡ã®å‡¦ç†ï¼ˆ.thenï¼‰ãŒå‹•ä½œã™ã‚‹ã®ã‹ï¼Ÿ
PromiseãŒè§£æ±ºï¼ˆfulfilledï¼‰ã•ã‚ŒãŸã‚‰ã€.then() ã«ç™»éŒ²ã•ã‚ŒãŸã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯é–¢æ•°ãŒå®Ÿè¡Œã•ã‚Œã¾ã™ã€‚

âœ… æ­£ç¢ºãªè¡¨ç¾ã§è¨€ã†ã¨â€¦
Promise ãŒ è§£æ±ºï¼ˆfulfilledï¼‰ ã•ã‚ŒãŸã¨ã â†’ .then() ã«æ¸¡ã—ãŸé–¢æ•°ãŒ éåŒæœŸçš„ã«å‘¼ã³å‡ºã•ã‚Œã‚‹ã€‚

Promise ãŒ æ‹’å¦ï¼ˆrejectedï¼‰ ã•ã‚ŒãŸã¨ã â†’ .catch() ã«æ¸¡ã—ãŸé–¢æ•°ãŒå‘¼ã³å‡ºã•ã‚Œã‚‹ã€‚

ğŸ”„ å‡¦ç†ã®æµã‚Œï¼ˆç°¡å˜ãªä¾‹ï¼‰
js
const promise = new Promise((resolve, reject) => {
  setTimeout(() => {
    resolve('å®Œäº†ï¼');
  }, 1000);
});

promise.then(result => {
  console.log(result); // â†’ 'å®Œäº†ï¼' ãŒè¡¨ç¤ºã•ã‚Œã‚‹
});
ã“ã®å ´åˆï¼š

promise ã¯ 1ç§’å¾Œã« resolve ã•ã‚Œã‚‹ã€‚

.then() ã«æ¸¡ã•ã‚ŒãŸé–¢æ•°ãŒã€resolve ã®å€¤ 'å®Œäº†ï¼' ã‚’å—ã‘å–ã£ã¦å®Ÿè¡Œã•ã‚Œã‚‹ã€‚

ğŸ§  è£œè¶³ï¼šåŒæœŸã£ã½ãè¦‹ãˆã‚‹ã‘ã©éåŒæœŸ
.then() ã®ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã¯ã€PromiseãŒè§£æ±ºã•ã‚ŒãŸç¬é–“ã«ã™ãå®Ÿè¡Œã•ã‚Œã‚‹ã‚ã‘ã§ã¯ãªãã€ã‚¤ãƒ™ãƒ³ãƒˆãƒ«ãƒ¼ãƒ—ã®æ¬¡ã®ã‚¿ãƒ¼ãƒ³ã§éåŒæœŸçš„ã«å®Ÿè¡Œã•ã‚Œã¾ã™ã€‚
ã“ã‚Œã¯ã€JavaScriptã®éåŒæœŸãƒ¢ãƒ‡ãƒ«ï¼ˆãƒã‚¤ã‚¯ãƒ­ã‚¿ã‚¹ã‚¯ã‚­ãƒ¥ãƒ¼ï¼‰ã«ã‚ˆã‚‹ã‚‚ã®ã§ã™ã€‚


âœ… é€²åŒ–ã®æµã‚Œ
å‡¦ç†ï¼ˆAPI ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã¦è¡¨ç¤ºã™ã‚‹ï¼‰ã‚’ ã€Œã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ â†’ Promise â†’ async/awaitã€ ã®é †ã§æ¯”è¼ƒã—ã¦ã¿ã¾ã™ã€‚

1. ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼ˆæ˜”ã®æ›¸ãæ–¹ï¼‰
// ãƒ‡ãƒ¼ã‚¿å–å¾—é–¢æ•°ï¼ˆã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚’å—ã‘å–ã‚‹ï¼‰
function getData(callback) {
  fetch("https://jsonplaceholder.typicode.com/posts/1")
    .then(response => response.json())
    .then(data => callback(null, data))
    .catch(error => callback(error));
}

// å®Ÿè¡Œ
getData((error, result) => {
  if (error) {
    console.error("ã‚¨ãƒ©ãƒ¼:", error);
  } else {
    console.log("æˆåŠŸ:", result);
  }
});


ğŸ‘‰ ãƒã‚¹ãƒˆãŒå¢—ãˆã‚‹ã¨ã€Œã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯åœ°ç„ã€ã«ãªã‚ŠãŒã¡ã€‚

2. Promiseï¼ˆES6, 2015ã€œï¼‰
// ãƒ‡ãƒ¼ã‚¿å–å¾—é–¢æ•°ï¼ˆPromise ã‚’è¿”ã™ï¼‰
function getData() {
  return fetch("https://jsonplaceholder.typicode.com/posts/1")
    .then(response => response.json());
}

// å®Ÿè¡Œ
getData()
  .then(result => {
    console.log("æˆåŠŸ:", result);
  })
  .catch(error => {
    console.error("ã‚¨ãƒ©ãƒ¼:", error);
  });


ğŸ‘‰ .then() ã§å‡¦ç†ã‚’ã¤ãªã’ã‚‰ã‚Œã‚‹ã®ã§èª­ã¿ã‚„ã™ããªã£ãŸã€‚
ğŸ‘‰ ã§ã‚‚ .then().then().catch() ã®ãƒã‚§ãƒ¼ãƒ³ãŒé•·ã„ã¨å°‘ã—èª­ã¿ã«ãã„ã€‚

3. async/awaitï¼ˆES2017, 2017ã€œï¼‰
// async/await ã‚’ä½¿ã£ãŸæ›¸ãæ–¹
async function getData() {
  try {
    const response = await fetch("https://jsonplaceholder.typicode.com/posts/1");
    const result = await response.json();
    console.log("æˆåŠŸ:", result);
  } catch (error) {
    console.error("ã‚¨ãƒ©ãƒ¼:", error);
  }
}

getData();


ğŸ‘‰ åŒæœŸå‡¦ç†ã£ã½ãé †ç•ªã«æ›¸ã‘ã‚‹ ã®ã§ç›´æ„Ÿçš„ã€‚
ğŸ‘‰ try/catch ã§ã‚¨ãƒ©ãƒ¼å‡¦ç†ã§ãã‚‹ã®ã‚‚å¤§ããªãƒ¡ãƒªãƒƒãƒˆã€‚

ğŸ“Œ ã¾ã¨ã‚

ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ â†’ å¤ã„ã‘ã©ä»Šã§ã‚‚ä¸€éƒ¨ã§æ®‹ã£ã¦ã‚‹

Promise â†’ ES6 ã§å°å…¥ã€ãƒã‚¹ãƒˆãŒè§£æ¶ˆã•ã‚ŒãŸ

async/await â†’ ES2017 ã§å°å…¥ã€ã•ã‚‰ã«ã‚·ãƒ³ãƒ—ãƒ«ã§èª­ã¿ã‚„ã™ã„