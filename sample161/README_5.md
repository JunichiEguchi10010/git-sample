JavaScript ã‚¤ãƒ™ãƒ³ãƒˆãƒ«ãƒ¼ãƒ— éåŒæœŸAPI ã«ã¤ã„ã¦ 20250901

éåŒæœŸAPIã¨ã‚¤ãƒ™ãƒ³ãƒˆãƒ«ãƒ¼ãƒ—ã®é–¢ä¿‚ã¯ã€JavaScriptã‚„Node.jsã®è¨­è¨ˆæ€æƒ³ã«æ·±ãé–¢ã‚ã‚‹é‡è¦ãªãƒ†ãƒ¼ãƒã§ã™ã€‚

ğŸ§  ãªãœã€ŒéåŒæœŸAPIã€ãŒå¿…è¦ãªã®ã‹ï¼Ÿ
ç¾ä»£ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯ã€å¾…ã¡æ™‚é–“ãŒã‚ã‚‹å‡¦ç†ï¼ˆI/Oã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã€ã‚¿ã‚¤ãƒãƒ¼ãªã©ï¼‰ã‚’å¤§é‡ã«æ‰±ã„ã¾ã™ã€‚
ã‚‚ã—ã“ã‚Œã‚‰ã‚’ã™ã¹ã¦ã€ŒåŒæœŸçš„ã€ã«å‡¦ç†ã™ã‚‹ã¨ã€1ã¤ã®å‡¦ç†ãŒçµ‚ã‚ã‚‹ã¾ã§ä»–ã®å‡¦ç†ãŒæ­¢ã¾ã£ã¦ã—ã¾ã„ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“ãŒæ‚ªåŒ–ã—ã¾ã™ã€‚

ãã“ã§ç™»å ´ã™ã‚‹ã®ãŒã€ŒéåŒæœŸAPIã€ã€‚ã“ã‚Œã¯ã€å‡¦ç†ã‚’ä¾é ¼ã—ãŸã‚‰ã™ãã«æ¬¡ã®å‡¦ç†ã«é€²ã¿ã€çµæœãŒè¿”ã£ã¦ããŸã‚‰å¾Œã§é€šçŸ¥ã™ã‚‹ã¨ã„ã†ã‚¹ã‚¿ã‚¤ãƒ«ã§ã™ã€‚ã¾ã‚‹ã§ã€Œä»•äº‹ã‚’é ¼ã‚“ã§ãŠã„ã¦ã€è¿”äº‹ãŒæ¥ã‚‹ã¾ã§åˆ¥ã®ä»•äº‹ã‚’ã—ã¦ã„ã‚‹ã€ã‚ˆã†ãªã‚‚ã®ã§ã™ã€‚

ğŸ”„ ã‚¤ãƒ™ãƒ³ãƒˆãƒ«ãƒ¼ãƒ—ã¨ã¯ä½•ã‹ï¼Ÿ
ã‚¤ãƒ™ãƒ³ãƒˆãƒ«ãƒ¼ãƒ—ã¯ã€JavaScriptã‚„Node.jsãŒéåŒæœŸå‡¦ç†ã‚’ç®¡ç†ã™ã‚‹ä»•çµ„ã¿ã§ã™ã€‚
ä»¥ä¸‹ã®ã‚ˆã†ãªæµã‚Œã§å‹•ã„ã¦ã„ã¾ã™ï¼š

ğŸ§© ã‚¤ãƒ™ãƒ³ãƒˆãƒ«ãƒ¼ãƒ—ã®åŸºæœ¬æ§‹é€ 
é …ç›®	                            èª¬æ˜
Call Stack	                       åŒæœŸå‡¦ç†ãŒç©ã¾ã‚Œã‚‹å ´æ‰€ã€‚é–¢æ•°ãŒå‘¼ã°ã‚Œã‚‹ã¨ã“ã“ã«ç©ã¾ã‚Œã‚‹ã€‚
Task Queueï¼ˆãƒã‚¯ãƒ­ã‚¿ã‚¹ã‚¯ï¼‰	        setTimeout ã‚„ I/O ãªã©ã®éåŒæœŸå‡¦ç†ãŒå®Œäº†ã—ãŸã‚‰ã“ã“ã«å…¥ã‚‹ã€‚
Microtask Queueï¼ˆãƒã‚¤ã‚¯ãƒ­ã‚¿ã‚¹ã‚¯ï¼‰	Promise.then() ã‚„ queueMicrotask() ãªã©ã®ç´°ã‹ã„éåŒæœŸå‡¦ç†ãŒã“ã“ã«å…¥ã‚‹ã€‚

ğŸ” å‡¦ç†ã®æµã‚Œ
Call Stack ãŒç©ºã«ãªã‚‹ã¾ã§åŒæœŸå‡¦ç†ã‚’å®Ÿè¡Œ

Microtask Queue ã‚’ã™ã¹ã¦å®Ÿè¡Œ

Task Queue ã‹ã‚‰1ã¤å–ã‚Šå‡ºã—ã¦å®Ÿè¡Œ

1ã€œ3ã‚’ç¹°ã‚Šè¿”ã™

ã“ã®ãƒ«ãƒ¼ãƒ—ãŒé«˜é€Ÿã§å›ã‚‹ã“ã¨ã§ã€éåŒæœŸå‡¦ç†ãŒã€Œé †ç•ªã«ã€ã€ŒåŠ¹ç‡ã‚ˆãã€å®Ÿè¡Œã•ã‚Œã¾ã™ã€‚

ğŸ§ª å®Ÿä¾‹ã§ç†è§£ã™ã‚‹
javascript
console.log('A');

setTimeout(() => {
  console.log('B');
}, 0);

Promise.resolve().then(() => {
  console.log('C');
});

console.log('D');
å‡ºåŠ›é †ï¼š
ã‚³ãƒ¼ãƒ‰
A
D
C
B
ãªãœã“ã®é †ç•ªï¼Ÿ
Aã¨Dã¯åŒæœŸå‡¦ç† â†’ ã™ãå®Ÿè¡Œ

Promise.then() ã¯ Microtask â†’ åŒæœŸã®å¾Œã™ãå®Ÿè¡Œ

setTimeout(..., 0) ã¯ Task Queue â†’ 1ãƒ«ãƒ¼ãƒ—å¾Œã«å®Ÿè¡Œ

ã“ã®ã‚ˆã†ã«ã€Microtaskï¼ˆPromiseï¼‰ã¯Taskï¼ˆsetTimeoutï¼‰ã‚ˆã‚Šã‚‚å„ªå…ˆã•ã‚Œã‚‹ã®ãŒã‚¤ãƒ™ãƒ³ãƒˆãƒ«ãƒ¼ãƒ—ã®ç‰¹å¾´ã§ã™ã€‚

â“ éåŒæœŸAPIã¯Promisãƒ™ãƒ¼ã‚¹ã§ã™ã‹ï¼Ÿ
ã¯ã„ã€ç¾åœ¨ã®JavaScriptã«ãŠã‘ã‚‹éåŒæœŸAPIã®å¤šãã¯Promiseãƒ™ãƒ¼ã‚¹ã§è¨­è¨ˆã•ã‚Œã¦ã„ã¾ã™ã€‚
ã“ã‚Œã¯ã€éåŒæœŸå‡¦ç†ã®çµæœã‚’ã€Œå°†æ¥ã€å—ã‘å–ã‚‹ã“ã¨ã‚’ç´„æŸã™ã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã§ã‚ã‚Šã€ä»¥å‰ã®ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯æ–¹å¼ã«æ¯”ã¹ã¦ã€å¯èª­æ€§ãƒ»ä¿å®ˆæ€§ãƒ»ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®é¢ã§å¤§ããªé€²åŒ–ã‚’ã‚‚ãŸã‚‰ã—ã¾ã—ãŸ2ã€‚

ğŸ”§ Promiseãƒ™ãƒ¼ã‚¹ã®ä»£è¡¨çš„ãªéåŒæœŸAPI
APIå	        èª¬æ˜
fetch()	        ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒªã‚¯ã‚¨ã‚¹ãƒˆã€‚Promiseã‚’è¿”ã™ã€‚
setTimeout()	å³å¯†ã«ã¯Promiseã‚’è¿”ã•ãªã„ãŒã€ãƒ©ãƒƒãƒ—å¯èƒ½ã€‚
axios	        Promiseãƒ™ãƒ¼ã‚¹ã®HTTPã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã€‚
navigator.geolocation.getCurrentPosition()	ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯æ–¹å¼ã ãŒã€PromiseåŒ–å¯èƒ½ã€‚

ğŸ§ª Promiseã®åŸºæœ¬æ§‹æ–‡
javascript
const promise = new Promise((resolve, reject) => {
  const success = true;
  if (success) {
    resolve("æˆåŠŸã—ã¾ã—ãŸ");
  } else {
    reject("å¤±æ•—ã—ã¾ã—ãŸ");
  }
});

promise
  .then(result => console.log(result))
  .catch(error => console.error(error));
ã“ã®ã‚ˆã†ã«ã€éåŒæœŸå‡¦ç†ã®æˆåŠŸãƒ»å¤±æ•—ã‚’æ˜ç¤ºçš„ã«æ‰±ãˆã‚‹ã®ãŒPromiseã®å¼·ã¿ã§ã™ã€‚

ğŸ§˜ async/awaitã¨ã®é–¢ä¿‚
Promiseã¯async/awaitã®åŸºç›¤ã§ã‚‚ã‚ã‚Šã¾ã™ã€‚awaitã¯Promiseã®å®Œäº†ã‚’å¾…ã¤æ§‹æ–‡ç³–è¡£ã§ã‚ã‚Šã€éåŒæœŸå‡¦ç†ã‚’åŒæœŸçš„ã«æ›¸ã‘ã‚‹ã‚ˆã†ã«è¦‹ã›ã‚‹ã“ã¨ã§ã€ã•ã‚‰ã«ã‚³ãƒ¼ãƒ‰ã®å¯èª­æ€§ã‚’é«˜ã‚ã¾ã™ã€‚

javascript
async function getData() {
  try {
    const response = await fetch("https://api.example.com/data");
    const json = await response.json();
    console.log(json);
  } catch (error) {
    console.error("ã‚¨ãƒ©ãƒ¼:", error);
  }
}